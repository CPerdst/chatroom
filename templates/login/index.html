{%load static%}
<html>
    <head>
        <title>登录</title>
        <link rel="stylesheet" type="text/css" href="{%static 'login/index.css'%}">
    </head>
    <body>
        <form>
            <input type="text" required placeholder="账号" id="account">
            <input type="password" required placeholder="密码" id="password">
        </form>
        <button onclick="Post()">登录</button>
        <button onclick="goregist()">注册</button>
        <p id="infor"></p>
    </body>
</html>
<script lang="JavaScript" type="text/javascript">
    function Post(){
        if(document.getElementById('account').value==''||document.getElementById('password').value==''){
            document.getElementById('infor').innerText="请输入完整"
        }else{
            if(window.XMLHttpRequest){
                var xhr = new XMLHttpRequest();
            }else{
                var xhr = new ActiveXObject('Microsoft.XMLHTTP');
            }
            xhr.onreadystatechange=function(){
                if(xhr.readyState==4 && xhr.status==200){
                    if(xhr.responseText=='login successfully'){
                        window.location.href='/chatroom/'
                    }
                    document.getElementById('infor').innerText=xhr.responseText
                }
            }
            var url = '/login/?account='+document.getElementById('account').value+'&password='+document.getElementById('password').value
            xhr.open('get',url,true)
            xhr.send()
        }
    };
    window.onload = function(){
        // console.log(document.cookie)
        if(getcok('userid')){
            document.getElementById('infor').innerHTML='<p>您已经登录，<a href="/chatroom/" style="color:green">点我</a>进入聊天房</p>'
        }
    }
    function getcok(name){
        if(document.cookie){
            var strcookie = document.cookie.split(' ').join('')
            var arrcookie = strcookie.split(';')
            for(var i = 0;i<arrcookie.length;i++){
                var arr = arrcookie[i].split('=')
                if(arr[0]==name)return arr[1]
            }
        }else return ''
    }
    function goregist(){
        window.location.href='/regist/'
    }
</script>